---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: ndrake-blue
description: This is my personal OS image.

base-image: ghcr.io/ublue-os/bluefin-dx
image-version: latest

modules:
  - type: signing
  
  - type: rpm-ostree
    install:
      - kmodtool
      - akmods
      - dkms
      - kernel-devel
  
  - type: script
    execute: |
      #!/bin/bash
      set -exo pipefail
      
      # Create a post-installation script to install rtl88xxau
      mkdir -p /usr/lib/ublue-os/first-boot/
      cat > /usr/lib/ublue-os/first-boot/50-install-rtl88xxau.sh << 'EOF'
      #!/bin/bash
      echo "Installing rtl88xxau driver on first boot..."
      rpm-ostree install rtl88xxau
      # This will require a reboot to take effect
      echo "rtl88xxau driver installed, please reboot to activate."
      EOF
      
      chmod +x /usr/lib/ublue-os/first-boot/50-install-rtl88xxau.sh